<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GyzenLyoraa Shield — Mobile Web2APK & ObfHTML</title>
<meta name="description" content="GyzenLyoraa Shield — convert web to apk, obfuscate html, themes, particles, sounds, console & telegram relay (placeholder token)" />
<style>
  /* =======================
     CONFIG: styling foundation
     ======================= */
  :root{
    --bg:#06060a;
    --glass: rgba(255,255,255,0.04);
    --glass-strong: rgba(255,255,255,0.06);
    --muted: rgba(255,255,255,0.6);
    --txt:#ecf8ff;
    --accent:#39f;
    --accent-2:#8b5cf6;
    --danger:#ff6b6b;
    --success:#3ee083;
    --card-radius:14px;
    --ui-padding:14px;
    font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  /* Reset */
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:var(--bg);color:var(--txt);-webkit-font-smoothing:antialiased;overflow:hidden}
  a{color:inherit}
  /* Layout - mobile-first */
  .app{position:relative;min-height:100vh;display:flex;flex-direction:column;align-items:stretch;z-index:1}
  header{position:fixed;top:0;left:0;right:0;height:64px;display:flex;align-items:center;gap:10px;padding:10px var(--ui-padding);z-index:60;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));backdrop-filter:blur(8px);border-bottom:1px solid rgba(255,255,255,0.03)}
  .hamburger{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;background:transparent;border:1px solid rgba(255,255,255,0.03);cursor:pointer}
  .hamburger .bars{width:20px;height:2px;background:var(--accent);box-shadow:0 6px 0 var(--accent),0 -6px 0 var(--accent);border-radius:2px}
  header .title{font-weight:700;font-size:16px;letter-spacing:0.4px}
  /* Sidebar */
  .sidebar{position:fixed;top:72px;left:10px;width:260px;max-width:76vw;height:calc(100vh - 92px);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:12px;box-shadow:0 20px 50px rgba(0,0,0,0.6);transform:translateX(-320px);transition:transform .28s;z-index:80;backdrop-filter:blur(10px)}
  .sidebar.open{transform:translateX(0)}
  .sidebar h3{margin:0 0 8px 0}
  .sidebar .row{margin-top:10px}
  .sidebar label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
  .sidebar input[type=text],.sidebar input[type=color],.sidebar select{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--txt)}
  .sidebar button{width:100%;margin-top:10px;padding:10px;border-radius:9px;border:none;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#031018;font-weight:700}
  /* content area */
  .content{padding:86px var(--ui-padding) 120px;display:flex;flex-direction:column;align-items:center;gap:12px;overflow:hidden}
  .banner{width:94%;height:84px;border-radius:10px;overflow:hidden;position:relative;border:1px solid rgba(255,255,255,0.04);object-fit:cover}
  .banner img{width:100%;height:100%;object-fit:cover}
  .main-card{width:94%;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);backdrop-filter:blur(6px)}
  .section-title{font-weight:700;margin-bottom:8px}
  .form-row{display:flex;gap:8px;flex-direction:column;margin-bottom:8px}
  .form-row label{font-size:13px;color:var(--muted)}
  input[type=text],input[type=url],input[type=email],textarea,select{width:100%;padding:10px;border-radius:8px;border:1px dashed rgba(255,255,255,0.04);background:transparent;color:var(--txt)}
  input[type=file]{color:var(--muted)}
  .icon-preview{width:96px;height:96px;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.04);display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12))}
  .icon-preview img{width:100%;height:100%;object-fit:cover}
  .actions{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .btn{padding:12px 14px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#00121a;font-weight:800;box-shadow:0 10px 30px rgba(59,130,246,0.08);cursor:pointer}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--txt)}
  .terminal{margin-top:12px;background:linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.6));border-radius:10px;padding:10px;font-family:monospace;font-size:13px;max-height:240px;overflow:auto;border:1px solid rgba(255,255,255,0.02)}
  .log{margin:8px 0;line-height:1.35}
  .small{font-size:12px;color:var(--muted)}
  /* popup modal */
  .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:120}
  .modal-backdrop.show{display:flex}
  .modal{width:92%;max-width:720px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:14px;border:1px solid rgba(255,255,255,0.03);backdrop-filter:blur(8px)}
  .modal .head{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
  /* fixed footer */
  footer{position:fixed;left:0;right:0;bottom:0;padding:10px var(--ui-padding);display:flex;justify-content:center;z-index:50}
  .foot-card{width:94%;max-width:720px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));border-radius:12px;padding:8px;border:1px solid rgba(255,255,255,0.02);text-align:center;font-size:13px;color:var(--muted)}
  /* blur overlay when sidebar open */
  .page-blur{position:fixed;inset:0;background:rgba(0,0,0,0.35);backdrop-filter:blur(8px);z-index:70;display:none}
  .page-blur.show{display:block}
  /* responsive */
  @media(min-width:900px){
    body{overflow:hidden}
    .content{align-items:center}
    .banner{height:120px}
  }
</style>
</head>
<body>
<!-- ===========================
     CONFIG (Edit these safely)
     - BG_IMAGE_URL & BANNER_URL = Catbox direct links
     - BOT_TOKEN & CHAT_ID = fill only for personal use (unsafe to share)
     =========================== -->
<script>
  /* CONFIG (edit locally only) */
  const BG_IMAGE_URL = 'https://files.catbox.moe/uvxiji.jpg';    // <--- replace with Catbox background (optional)
  const BANNER_URL = 'https://files.catbox.moe/1kfb3f.gif';         // <--- replace with Catbox banner 19:6
  const ALLOW_TELEGRAM_RELAY = false; // set true if you WILL add BOT_TOKEN below (local/private only)
  const BOT_TOKEN = '<PUT_BOT_TOKEN_HERE_IF_PRIVATE>';   // <-- DO NOT SHARE FILE if you place token here
  const CHAT_ID = '<PUT_CHAT_ID_HERE_IF_PRIVATE>';      // <-- chat id to send messages/files
  /* end CONFIG */
</script>

<div class="app" id="app">
  <header>
    <div class="hamburger" id="menuBtn" title="Menu">
      <div class="bars"></div>
    </div>
    <div class="title">GyzenLyoraa Shield</div>
    <div style="flex:1"></div>
    <div style="display:flex;gap:8px;align-items:center">
      <button class="btn ghost" id="themePickerBtn">Theme</button>
    </div>
  </header>

  <aside class="sidebar" id="sidebar">
    <h3>⚙ Pengaturan</h3>

    <div class="row">
      <label>Preset Tema</label>
      <select id="presetTheme">
        <option value="#39f,#8b5cf6">Neon Cyan - Purple</option>
        <option value="#16a34a,#86efac">Green Mint</option>
        <option value="#ef4444,#f97316">Red - Orange</option>
        <option value="#f59e0b,#facc15">Gold</option>
        <option value="#06b6d4,#7c3aed">Aqua Violet</option>
      </select>
    </div>

    <div class="row">
      <label>Warna Utama</label>
      <input type="color" id="themeColor" value="#39f">
    </div>

    <div class="row">
      <label>Background (Catbox URL)</label>
      <input type="text" id="bgInput" placeholder="https://files.catbox.moe/xxxxxx.jpg" />
      <button id="applyBgBtn">Terapkan Background</button>
      <div class="small" style="margin-top:6px">Masukkan link Catbox lalu tekan Terapkan.</div>
    </div>

    <div class="row">
      <label><input type="checkbox" id="toggleParticles" checked> Efek Partikel</label>
      <label><input type="checkbox" id="toggleTrail" checked> Mouse Trail</label>
      <label><input type="checkbox" id="toggleSound" checked> Suara Tombol</label>
    </div>

    <div class="row">
      <label>Toggle Music</label>
      <select id="musicSelect">
        <option value="">(Off)</option>
        <option value="https://cdn.pixabay.com/download/audio/2022/03/15/audio_6a2f8f0fb1.mp3?filename=relaxing-background-ambient-12776.mp3">Ambient Chill</option>
        <option value="https://cdn.pixabay.com/download/audio/2022/03/22/audio_3e1a3fb6b1.mp3?filename=futuristic-technology-14703.mp3">Futuristic</option>
      </select>
    </div>

    <div class="row">
      <label>Misc</label>
      <button id="clearHistoryBtn" class="btn ghost">Clear History</button>
    </div>

    <div class="row small" style="margin-top:12px">
      <div>v1.0 • GyzenLyoraa</div>
    </div>
  </aside>

  <div class="page-blur" id="pageBlur"></div>

  <div class="content" id="content">
    <div class="banner">
      <img id="bannerImg" src="" alt="Banner 19:6">
    </div>

    <div class="main-card" id="mainCard">
      <div class="section">
        <div class="section-title">Web → APK (Web2APK)</div>
        <div class="form-row">
          <label>URL</label>
          <input id="inputUrl" type="url" placeholder="https://example.com">
        </div>
        <div class="form-row">
          <label>Nama Aplikasi</label>
          <input id="inputAppName" type="text" placeholder="Nama App">
        </div>
        <div class="form-row">
          <label>Email</label>
          <input id="inputEmail" type="email" placeholder="you@example.com">
        </div>
        <div class="form-row" style="display:flex;gap:8px;align-items:center">
          <div style="flex:1">
            <label>Upload Icon</label>
            <input id="inputIcon" type="file" accept="image/*">
            <div class="small">Icon akan diupload ke CDN dan digunakan untuk build.</div>
          </div>
          <div class="icon-preview" id="iconPreview">
            <img id="iconPreviewImg" src="" alt="Icon preview">
          </div>
        </div>

        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn" id="buildBtn">Build APK</button>
          <button class="btn ghost" id="openObfBtn">Obfuscate HTML</button>
          <button class="btn ghost" id="viewHistoryBtn">History</button>
        </div>

        <div class="small" style="margin-top:8px">Note: endpoints pihak ketiga digunakan untuk build; CORS dapat menghalangi upload pada beberapa CDN.</div>
      </div>

      <div style="height:12px"></div>

      <div class="section">
        <div class="section-title">Console</div>
        <div class="terminal" id="terminal"></div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn ghost" id="clearBtn">Clear</button>
          <button class="btn ghost" id="saveLogsBtn">Save Logs</button>
          <div style="flex:1" class="small" id="logsInfo">—</div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="foot-card">Made with ♥ by GyzenLyoraa — Mobile-first • Keep BOT_TOKEN private</div>
  </footer>

  <!-- modal -->
  <div class="modal-backdrop" id="modal">
    <div class="modal" role="dialog" aria-modal="true">
      <div class="head">
        <div>
          <div id="modalTitle" style="font-weight:800">Modal</div>
          <div id="modalSub" class="small" style="margin-top:4px;color:var(--muted)"></div>
        </div>
        <div>
          <button id="modalClose" class="btn ghost">Close</button>
        </div>
      </div>
      <div id="modalBody"></div>
    </div>
  </div>

  <!-- canvases -->
  <canvas id="particles" style="position:fixed;inset:0;z-index:0;pointer-events:none"></canvas>
  <canvas id="trail" style="position:fixed;inset:0;z-index:1;pointer-events:none"></canvas>
</div>

<script>
/* =========================
   APP INITIALIZATION
   ========================= */
const sidebar = document.getElementById('sidebar');
const menuBtn = document.getElementById('menuBtn');
const pageBlur = document.getElementById('pageBlur');
const themeColor = document.getElementById('themeColor');
const presetTheme = document.getElementById('presetTheme');
const bannerImg = document.getElementById('bannerImg');
const bgInput = document.getElementById('bgInput');
const applyBgBtn = document.getElementById('applyBgBtn');
const toggleParticles = document.getElementById('toggleParticles');
const toggleTrail = document.getElementById('toggleTrail');
const toggleSound = document.getElementById('toggleSound');
const musicSelect = document.getElementById('musicSelect');
const modal = document.getElementById('modal');
const modalBody = document.getElementById('modalBody');
const modalTitle = document.getElementById('modalTitle');
const modalSub = document.getElementById('modalSub');
const modalClose = document.getElementById('modalClose');
const terminal = document.getElementById('terminal');
const clearBtn = document.getElementById('clearBtn');
const saveLogsBtn = document.getElementById('saveLogsBtn');
const buildBtn = document.getElementById('buildBtn');
const inputUrl = document.getElementById('inputUrl');
const inputAppName = document.getElementById('inputAppName');
const inputEmail = document.getElementById('inputEmail');
const inputIcon = document.getElementById('inputIcon');
const iconPreviewImg = document.getElementById('iconPreviewImg');
const openObfBtn = document.getElementById('openObfBtn');
const applyThemeBtn = document.getElementById('themePickerBtn');
const viewHistoryBtn = document.getElementById('viewHistoryBtn');
const clearHistoryBtn = document.getElementById('clearHistoryBtn');
const logsInfo = document.getElementById('logsInfo');

let logs = JSON.parse(localStorage.getItem('rd_logs')||'[]');
let historyBuilds = JSON.parse(localStorage.getItem('rd_builds')||'[]');

const DEFAULT_BG = (() => { try { return BG_IMAGE_URL } catch(e){ return '' } })();
const DEFAULT_BANNER = (() => { try { return BANNER_URL } catch(e){ return '' } })();

bannerImg.src = DEFAULT_BANNER || 'https://files.catbox.moe/your-banner.jpg';
if(DEFAULT_BG) document.body.style.background = `url('${DEFAULT_BG}') center/cover fixed`;

function setAccent(colorA,colorB){
  document.documentElement.style.setProperty('--accent', colorA);
  document.documentElement.style.setProperty('--accent-2', colorB||colorA);
}
(function initTheme(){
  const preset = presetTheme.value.split(',');
  setAccent(preset[0],preset[1]);
  themeColor.value = preset[0];
})();
presetTheme.addEventListener('change', ()=>{
  const [a,b]=presetTheme.value.split(',');
  setAccent(a,b);
  themeColor.value = a;
});
themeColor.addEventListener('input', ()=> setAccent(themeColor.value, themeColor.value));
applyBgBtn.addEventListener('click', ()=> {
  const v = bgInput.value.trim();
  if(!v) return alert('Masukkan URL background dari Catbox');
  document.body.style.background = `url('${v}') center/cover fixed`;
  log('Background diterapkan dari input', 'info');
});

/* sidebar open/close & blur (no scroll) */
menuBtn.addEventListener('click', ()=>{
  sidebar.classList.toggle('open');
  pageBlur.classList.toggle('show');
  document.body.style.overflow = sidebar.classList.contains('open') ? 'hidden' : 'auto';
});
pageBlur.addEventListener('click', ()=> { sidebar.classList.remove('open'); pageBlur.classList.remove('show'); document.body.style.overflow='auto' });

/* modal */
function showModal(title, sub, html){
  modalTitle.innerText = title;
  modalSub.innerText = sub||'';
  modalBody.innerHTML = html || '<div class="small">Please wait…</div>';
  modal.classList.add('show');
  modal.style.display = 'flex';
  document.body.style.overflow='hidden';
}
function closeModal(){
  modal.classList.remove('show'); modal.style.display='none';
  modalBody.innerHTML = '';
  document.body.style.overflow='auto';
}
modalClose.addEventListener('click', closeModal);
modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });

/* logs */
function log(text, type='info'){
  const t = new Date().toLocaleTimeString();
  const el = document.createElement('div');
  el.className = 'log';
  el.innerHTML = `<span style="color:var(--muted)">[${t}]</span> ${escapeHtml(text)}`;
  if(type==='err') el.style.color = getComputedStyle(document.documentElement).getPropertyValue('--danger')||'#ff6b6b';
  if(type==='success') el.style.color = getComputedStyle(document.documentElement).getPropertyValue('--success')||'#3ee083';
  terminal.appendChild(el);
  terminal.scrollTop = terminal.scrollHeight;
  logs.push({t:new Date().toISOString(),type,text});
  localStorage.setItem('rd_logs', JSON.stringify(logs.slice(-500)));
  logsInfo.innerText = `${logs.length} logs • ${historyBuilds.length} builds`;
}
function escapeHtml(s){ return (s+'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
clearBtn.addEventListener('click', ()=>{ terminal.innerHTML=''; logs=[]; localStorage.setItem('rd_logs', JSON.stringify([])); log('Console cleared', 'info');});
saveLogsBtn.addEventListener('click', ()=> {
  const blob = new Blob([JSON.stringify(logs, null, 2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='reodel_logs.json'; a.click(); URL.revokeObjectURL(url);
  log('Logs downloaded', 'success');
});
clearHistoryBtn.addEventListener('click', ()=> { historyBuilds=[]; localStorage.setItem('rd_builds','[]'); log('Build history cleared', 'warn');});

/* load saved logs into UI on start */
(function loadSaved(){
  logs.slice(-50).forEach(l => {
    const el = document.createElement('div'); el.className='log'; el.innerHTML=`<span style="color:var(--muted)">[${new Date(l.t).toLocaleTimeString()}]</span> ${escapeHtml(l.text)}`; terminal.appendChild(el);
  });
  logsInfo.innerText = `${logs.length} logs • ${historyBuilds.length} builds`;
})();

/* sounds */
let buttonAudio = new Audio('https://actions.google.com/sounds/v1/ui/click_short.ogg');
buttonAudio.volume = 0.7;
musicSelect.addEventListener('change', ()=>{
  if(musicSelect.value){
    bgMusic.src = musicSelect.value;
    bgMusic.play().catch(()=>{});
  } else { bgMusic.pause(); bgMusic.currentTime=0; }
});
toggleSound.addEventListener('change', ()=>{ if(!toggleSound.checked) buttonAudio.muted=true; else buttonAudio.muted=false; });

/* background music */
const bgMusic = new Audio();
bgMusic.loop = true;
bgMusic.volume = 0.22;

/* button click sound wrapper */
function clickSound(){
  try{ if(toggleSound.checked) buttonAudio.play().catch(()=>{}); } catch(e){}
}

/* particles & trail */
const particlesCanvas = document.getElementById('particles');
const trailCanvas = document.getElementById('trail');
const Pctx = particlesCanvas.getContext('2d');
const Tctx = trailCanvas.getContext('2d');
let W = innerWidth, H = innerHeight;
function resizeCanvas(){ W = particlesCanvas.width = trailCanvas.width = innerWidth; H = particlesCanvas.height = trailCanvas.height = innerHeight;}
window.addEventListener('resize', resizeCanvas); resizeCanvas();
let particles = [];
function spawnParticles(){
  particles = [];
  const count = Math.max(30, Math.floor((W*H)/90000));
  for(let i=0;i<count;i++){
    particles.push({x:Math.random()*W,y:Math.random()*H,r:Math.random()*2+0.6,vx:(Math.random()-.5)*.6,vy:(Math.random()-.5)*.6,life:100+Math.random()*200});
  }
}
spawnParticles();
let mousePts = [];
document.addEventListener('mousemove', (e)=>{ mousePts.push({x:e.clientX,y:e.clientY,t:Date.now()}); if(mousePts.length>30) mousePts.shift(); });

function drawLoop(){
  requestAnimationFrame(drawLoop);
  if(toggleParticles.checked){
    Pctx.clearRect(0,0,W,H);
    for(let p of particles){
      p.x += p.vx; p.y += p.vy; p.life-=0.2;
      if(p.x<0||p.x>W) p.vx*=-1; if(p.y<0||p.y>H) p.vy*=-1;
      if(p.life<0){ Object.assign(p, {x:Math.random()*W,y:Math.random()*H,r:Math.random()*2+0.6,vx:(Math.random()-.5)*.6,vy:(Math.random()-.5)*.6,life:100+Math.random()*200}); }
      const g = Pctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*6);
      g.addColorStop(0, hexToRgba(getComputedStyle(document.documentElement).getPropertyValue('--accent')||'#39f', 0.18));
      g.addColorStop(1, hexToRgba(getComputedStyle(document.documentElement).getPropertyValue('--accent-2')||'#8b5cf6', 0.02));
      Pctx.fillStyle = g; Pctx.beginPath(); Pctx.arc(p.x,p.y,p.r,0,Math.PI*2); Pctx.fill();
    }
  } else { Pctx.clearRect(0,0,W,H); }

  if(toggleTrail.checked){
    Tctx.clearRect(0,0,W,H);
    for(let i=0;i<mousePts.length-1;i++){
      const a=mousePts[i], b=mousePts[i+1];
      const alpha = Math.max(0, 1 - (Date.now()-a.t)/900);
      Tctx.beginPath(); Tctx.moveTo(a.x,a.y); Tctx.lineTo(b.x,b.y);
      Tctx.lineWidth = 2 + i*0.06; Tctx.strokeStyle = rgbaString(getComputedStyle(document.documentElement).getPropertyValue('--accent')||'#39f', 0.16*alpha);
      Tctx.stroke();
    }
    // cleanup
    const now = Date.now(); while(mousePts.length && now - mousePts[0].t > 900) mousePts.shift();
  } else { Tctx.clearRect(0,0,W,H); }
}
drawLoop();

/* helper color converters */
function hexToRgba(hex, alpha){ try{ hex = hex.trim(); if(hex.startsWith('var')) hex='#39f'; if(hex.length===4){ hex = '#'+hex[1]+hex[1]+hex[2]+hex[2]+hex[3]+hex[3]; } const r=parseInt(hex.slice(1,3),16), g=parseInt(hex.slice(3,5),16), b=parseInt(hex.slice(5,7),16); return `rgba(${r},${g},${b},${alpha})`; }catch(e){ return `rgba(57,153,255,${alpha})`; } }
function rgbaString(hex, a){ return hexToRgba(hex,a); }

/* misc UI bindings */
applyThemeBtn.addEventListener('click', ()=> { sidebar.classList.toggle('open'); pageBlur.classList.toggle('show'); document.body.style.overflow = sidebar.classList.contains('open') ? 'hidden' : 'auto'; });
viewHistoryBtn.addEventListener('click', ()=> openHistory());
document.getElementById('viewHistoryBtn').addEventListener('click', ()=> openHistory());

/* icon preview */
inputIcon.addEventListener('change', async (e)=>{
  const f = e.target.files && e.target.files[0];
  if(!f) return;
  const url = URL.createObjectURL(f);
  iconPreviewImg.src = url;
  log('Icon selected: ' + f.name, 'info');
});

/* =========================
   WEB2APK flow (client-side)
   - Upload icon to CDN (example endpoint)
   - Request build API (example endpoint)
   - Optionally relay result to Telegram bot (requires BOT_TOKEN filled locally)
   ========================= */
async function uploadToCDN(file){
  // NOTE: endpoint may have CORS restriction. Replace with CDN that allows browser uploads.
  const endpoint = 'https://cdn.yupra.my.id/upload';
  const fd = new FormData();
  fd.append('files', file, 'icon.png');
  const res = await fetch(endpoint, {method:'POST', body:fd});
  if(!res.ok) throw new Error('CDN upload failed: ' + res.status);
  const j = await res.json();
  if(!j.success || !j.files || !j.files[0]) throw new Error('CDN invalid response');
  return 'https://cdn.yupra.my.id' + j.files[0].url;
}

function fetchTimeout(url,opts={},timeout=30000){
  return new Promise((resolve,reject)=>{
    const t = setTimeout(()=>reject(new Error('Request timeout')), timeout);
    fetch(url,opts).then(r=>{ clearTimeout(t); resolve(r); }).catch(e=>{ clearTimeout(t); reject(e); });
  });
}

buildBtn.addEventListener('click', async ()=>{
  clickSound();
  const url = inputUrl.value.trim(); const appName = inputAppName.value.trim() || 'ReoApp'; const email = inputEmail.value.trim();
  const iconFile = inputIcon.files[0];
  if(!url || !isValidUrl(url)){ log('URL tidak valid', 'err'); return; }
  if(!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){ log('Email tidak valid', 'err'); return; }
  if(!iconFile){ log('Upload icon terlebih dahulu', 'err'); return; }

  log(`Starting build for ${appName} — ${url}`, 'info');
  showModal('Building APK', `Memulai build <strong>${escapeHtml(appName)}</strong> — please wait...`);
  try {
    log('Uploading icon to CDN...', 'info');
    const iconUrl = await uploadToCDN(iconFile);
    log('Icon uploaded: ' + iconUrl, 'success');

    const buildApi = 'https://api.fikmydomainsz.xyz/tools/toapp/build-complete';
    const params = new URLSearchParams({url, email, appName, appIcon: iconUrl});
    log('Requesting build job...', 'info');
    const r = await fetchTimeout(buildApi + '?' + params.toString(), {}, 180000);
    if(!r.ok) { const txt = await r.text().catch(()=>null); throw new Error('Build API error: ' + r.status + ' ' + (txt||r.statusText)); }
    const job = await r.json();
    if(!job.status) throw new Error(job.error || 'Unknown build error');

    log('Build finished — download ready', 'success');
    historyBuilds.push({ts:new Date().toISOString(),appName,url,downloadUrl:job.downloadUrl});
    localStorage.setItem('rd_builds', JSON.stringify(historyBuilds.slice(-200)));

    // show link in modal
    setModalContent(`
      <div class="small">App: <strong>${escapeHtml(appName)}</strong></div>
      <a href="${job.downloadUrl}" target="_blank" rel="noopener noreferrer">${job.downloadUrl}</a>
      <div style="margin-top:8px;display:flex;gap:8px">
        <button id="copyLink" class="btn">Copy Link</button>
        <button id="sendTelegram" class="btn ghost">Send to Telegram (private)</button>
      </div>
    `);
    document.getElementById('copyLink').addEventListener('click', ()=> { navigator.clipboard.writeText(job.downloadUrl).then(()=>log('Link copied to clipboard','success')).catch(()=>log('Gagal salin','err')); });
    document.getElementById('sendTelegram').addEventListener('click', ()=> { sendToTelegram(`APK ready: ${appName}\n${job.downloadUrl}`); });
  } catch(err){
    log('Build failed: ' + (err.message||err), 'err');
    setModalContent(`<div class="small" style="color:var(--danger)">Error: ${escapeHtml(err.message||'unknown')}</div>`);
  }
});

function setModalContent(html){ modalBody.innerHTML = html; }

/* Telegram relay (simple sendMessage) — requires BOT_TOKEN & CHAT_ID in CONFIG and ALLOW_TELEGRAM_RELAY = true */
async function sendToTelegram(text){
  if(!ALLOW_TELEGRAM_RELAY){ alert('Telegram relay disabled. Enable ALLOW_TELEGRAM_RELAY in CONFIG to use.'); return; }
  if(!BOT_TOKEN || BOT_TOKEN.includes('<PUT')){ alert('BOT_TOKEN not configured'); return; }
  if(!CHAT_ID || CHAT_ID.includes('<PUT')){ alert('CHAT_ID not configured'); return; }
  log('Sending message to Telegram...', 'info');
  try {
    const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
    const r = await fetch(url, {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({chat_id:CHAT_ID, text})});
    const j = await r.json();
    if(!j.ok) throw new Error(j.description||'Telegram error');
    log('Telegram: message sent', 'success');
  } catch(e){ log('Telegram send failed: ' + (e.message||e), 'err'); }
}

/* =========================
   OBFUSCATE HTML (client-side AES-GCM)
   ========================= */
openObfBtn.addEventListener('click', ()=> {
  clickSound();
  showModal('Obfuscate HTML', 'Upload .html file and create self-decrypting HTML', `
    <div style="display:flex;gap:8px;flex-direction:column">
      <input id="obfFile" type="file" accept=".html,text/html">
      <input id="obfPass" type="text" placeholder="Optional password (leave blank for random)">
      <div style="display:flex;gap:8px">
        <button id="doObf" class="btn">Encrypt & Download</button>
        <button id="previewObf" class="btn ghost">Preview</button>
      </div>
      <div class="small" style="margin-top:8px">Encrypted file will include a small JS decryptor and embedded (masked) key.</div>
    </div>
  `);
  document.getElementById('doObf').addEventListener('click', doObfuscate);
  document.getElementById('previewObf').addEventListener('click', ()=> { document.getElementById('modalBody').appendChild(document.createElement('div')).innerText='Preview not implemented'; });
});

async function doObfuscate(){
  const fi = document.getElementById('obfFile');
  if(!fi.files || !fi.files[0]){ alert('Pilih file .html'); return; }
  const f = fi.files[0];
  log(`Encrypting ${f.name}...`, 'info');
  const pass = document.getElementById('obfPass').value || null;
  try{
    const buf = await f.arrayBuffer();
    let rawKeyBuf;
    let saltB64 = null;
    if(pass){
      const pw = new TextEncoder().encode(pass);
      const salt = crypto.getRandomValues(new Uint8Array(12));
      saltB64 = btoa(String.fromCharCode(...salt));
      const keyMaterial = await crypto.subtle.importKey('raw', pw, 'PBKDF2', false, ['deriveBits','deriveKey']);
      const key = await crypto.subtle.deriveKey({name:'PBKDF2',salt,iterations:120000,hash:'SHA-256'}, keyMaterial, {name:'AES-GCM',length:256}, true, ['encrypt','decrypt']);
      rawKeyBuf = await crypto.subtle.exportKey('raw', key);
    } else {
      rawKeyBuf = crypto.getRandomValues(new Uint8Array(32)).buffer;
    }
    const iv = crypto.getRandomValues(new Uint8Array(12));
    const cryptoKey = await crypto.subtle.importKey('raw', rawKeyBuf, {name:'AES-GCM'}, false, ['encrypt']);
    const cipher = await crypto.subtle.encrypt({name:'AES-GCM', iv}, cryptoKey, buf);
    const payload = {
      cipher: btoa(arrayBufferToString(new Uint8Array(cipher))),
      iv: btoa(arrayBufferToString(iv)),
      filename: f.name,
      keyHint: pass? 'password' : 'embedded',
      salt: saltB64
    };
    const decryptorHtml = createSelfDecryptor(payload, rawKeyBuf);
    const blob = new Blob([decryptorHtml], {type:'text/html'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download = `obf_${f.name}`; a.click(); URL.revokeObjectURL(url);
    log('Obfuscated HTML downloaded', 'success');
  }catch(e){ log('Obfuscate failed: ' + (e.message||e), 'err'); }
}

function arrayBufferToString(buf){ let s=''; for(let i=0;i<buf.length;i++) s+=String.fromCharCode(buf[i]); return s; }
function createSelfDecryptor(payload, rawKeyBuf){
  const payloadB64 = btoa(JSON.stringify(payload));
  const mask = crypto.getRandomValues(new Uint8Array(8));
  const rawKey = new Uint8Array(rawKeyBuf);
  const xored = new Uint8Array(rawKey.length);
  for(let i=0;i<rawKey.length;i++) xored[i] = rawKey[i] ^ mask[i%mask.length];
  const xoredB64 = btoa(arrayBufferToString(xored));
  const maskB64 = btoa(arrayBufferToString(mask));
  const clientJs = `
  (async()=>{
    try{
      const payload = JSON.parse(atob("${payloadB64}"));
      const xored = Uint8Array.from(atob("${xoredB64}"), c=>c.charCodeAt(0));
      const mask = Uint8Array.from(atob("${maskB64}"), c=>c.charCodeAt(0));
      for(let i=0;i<xored.length;i++) xored[i] = xored[i] ^ mask[i%mask.length];
      const rawKey = xored.buffer;
      const key = await crypto.subtle.importKey('raw', rawKey, {name:'AES-GCM'}, false, ['decrypt']);
      const iv = Uint8Array.from(atob(payload.iv), c=>c.charCodeAt(0));
      const cipher = Uint8Array.from(atob(payload.cipher), c=>c.charCodeAt(0));
      const plain = await crypto.subtle.decrypt({name:'AES-GCM', iv}, key, cipher);
      const dec = new TextDecoder().decode(plain);
      document.open(); document.write(dec); document.close();
    }catch(e){ document.body.innerText = 'GyzenLyoraa Shield - decrypt failed: '+(e.message||e); }
  })();`;
  return `<!doctype html><html><head><meta charset="utf-8"><title>obf:${payload.filename}</title></head><body><script>${clientJs}</script></body></html>`;
}

/* =========================
   History viewer
   ========================= */
function openHistory(){
  clickSound();
  const html = historyBuilds.slice(-50).reverse().map(h => {
    return `<div style="margin-bottom:8px;padding:8px;border-radius:8px;background:rgba(255,255,255,0.02)"><div class="small">${new Date(h.ts).toLocaleString()}</div><div><strong>${escapeHtml(h.appName)}</strong></div><div style="word-break:break-all"><a href="${h.downloadUrl}" target="_blank">${h.downloadUrl}</a></div></div>`;
  }).join('') || '<div class="small">No history</div>';
  showModal('Build History', '', `<div style="max-height:60vh;overflow:auto">${html}</div>`);
}

/* =========================
   Utilities
   ========================= */
function isValidUrl(u){ try{ new URL(u); return true }catch(e){ return false } }
function sleep(ms){ return new Promise(r=>setTimeout(r, ms)); }

/* =========================
   Final tips: show modal helper
   ========================= */
function setBanner(url){ if(url) bannerImg.src=url; }
if(BANNER_URL) setBanner(BANNER_URL);

/* expose small functions for debug */
window.Reo = { logs, historyBuilds, setBanner };

/* =========================
   IMPORTANT SECURITY NOTE
   - To enable Telegram relay, edit CONFIG at top:
     - set ALLOW_TELEGRAM_RELAY = true
     - fill BOT_TOKEN and CHAT_ID with your private values
   - Never share the file publicly if it contains your BOT_TOKEN.
   ========================= */

log('GyzenLyoraa Shield ready — mobile UI loaded', 'success');
</script>
</body>
</html>